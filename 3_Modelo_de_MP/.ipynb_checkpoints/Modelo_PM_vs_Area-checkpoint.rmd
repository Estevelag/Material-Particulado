---
title: "Modelos de MP por area"
output: html_notebook
---
En este notebook se harán los modelos de material particulado(MP) 2.5u y 10u por area se elige el notebook de R para hacer
el trabajo por bloques explicando la logica de cada paso. En teoria se debe aspirar a crear un codigo en donde se pueda correr
directamente con 0 intervencion.

Primero se importan las librerías necesarias para el análisis:

```{r}
library(lmtest)
library(readxl)
library(gvlma)
library(ggplot2)
```

Luego se importan los datos para el modelo, depurados previamente en el notebook de la carpeta "1_Arreglo_PM_DAP_estimacion_Alvarez":

```{r}
path_data<-"../data/Datos_para_modelo/Datos_MP_BiomasaEst_Altura.xlsx"
model_data <- read_excel(path_data)
```

Se empieza con la creacion de los modelos, se define un vector con datos a eliminar por tener efectos muy fuertes sobre 
el modelo lineal. Los datos eliminados aplican para los 2 modelos. 

```{r}
to_eliminate <- c(62)

modelo_25=lm(log(Material_2.5) ~ log(Area) + Tipo_Hoja + 0, data=model_data[-to_eliminate,])#[-c(61,62,32,168,242),])
summary(modelo_25)
anova(modelo_25)
plot(modelo_25)
#gvlma(modelo_25)
shapiro.test(modelo_25$residuals)
bptest(modelo_25)
```



```{r}
modelo_10=lm(log(Material_10) ~ log(Area) + Tipo_Hoja + 0, data=model_data[-to_eliminate,])#[-c(32,61,62,168,242),])

summary(modelo_10)
anova(modelo_10)
plot(modelo_10)
#gvlma(modelo_10)
shapiro.test(modelo_10$residuals)
bptest(modelo_10)
```

